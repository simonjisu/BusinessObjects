SELECT COUNT(DISTINCT s.S_SUPPKEY) AS supplier_count
FROM SUPPLIER s
JOIN NATION n ON s.S_NATIONKEY = n.N_NATIONKEY
JOIN REGION r ON n.N_REGIONKEY = r.R_REGIONKEY
JOIN PARTSUPP ps ON s.S_SUPPKEY = ps.PS_SUPPKEY
JOIN LINEITEM l ON ps.PS_PARTKEY = l.L_PARTKEY AND ps.PS_SUPPKEY = l.L_SUPPKEY
JOIN ORDERS o ON l.L_ORDERKEY = o.O_ORDERKEY
JOIN CUSTOMER c ON o.O_CUSTKEY = c.C_CUSTKEY
WHERE r.R_NAME = 'CANADA'
  AND o.O_ORDERDATE BETWEEN '1993-01-01' AND '1993-12-31'
GROUP BY ps.PS_PARTKEY, s.S_SUPPKEY, ps.PS_AVAILQTY
HAVING ps.PS_AVAILQTY > SUM(l.L_QUANTITY) * 1.5;