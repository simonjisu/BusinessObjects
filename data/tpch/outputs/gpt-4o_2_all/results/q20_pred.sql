SELECT COUNT(DISTINCT T1.S_SUPPKEY) AS num_suppliers
FROM SUPPLIER T1
JOIN NATION T2 ON T1.S_NATIONKEY = T2.N_NATIONKEY
JOIN LINEITEM T3 ON T1.S_SUPPKEY = T3.L_SUPPKEY
JOIN PARTSUPP T4 ON T3.L_PARTKEY = T4.PS_PARTKEY AND T3.L_SUPPKEY = T4.PS_SUPPKEY
WHERE T2.N_NAME = 'CANADA'
  AND strftime('%Y', T3.L_SHIPDATE) = '1993'
  AND (SELECT SUM(L_QUANTITY) FROM LINEITEM WHERE L_SUPPKEY = T1.S_SUPPKEY AND L_PARTKEY = T4.PS_PARTKEY AND strftime('%Y', L_SHIPDATE) = '1993') * 0.5 < T4.PS_AVAILQTY;