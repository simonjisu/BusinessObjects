SELECT COUNT(DISTINCT T1.S_SUPPKEY) AS num_suppliers
FROM SUPPLIER T1
JOIN NATION T2 ON T1.S_NATIONKEY = T2.N_NATIONKEY
JOIN REGION T3 ON T2.N_REGIONKEY = T3.R_REGIONKEY
JOIN PARTSUPP T4 ON T1.S_SUPPKEY = T4.PS_SUPPKEY
JOIN LINEITEM T5 ON T4.PS_PARTKEY = T5.L_PARTKEY AND T4.PS_SUPPKEY = T5.L_SUPPKEY
WHERE T2.N_NAME = 'CANADA'
  AND strftime('%Y', T5.L_SHIPDATE) = '1993'
  AND T4.PS_AVAILQTY > SUM(T5.L_QUANTITY) * 0.5
GROUP BY T1.S_SUPPKEY;